{-# OPTIONS --cubical #-}module Syntax0 whereopen import Data.Nat hiding (_^_)open import Data.Bool hiding  (_âˆ¨_ ; _âˆ§_)open import Cubical.Core.Everythingopen import Cubical.Foundations.Preludeopen import Cubical.Foundations.Isomorphism renaming (Iso to _â‰…_)open import SqrtPathinfix  19 _â‡”_infix  18 _â†”_infixr 25 _âŠ™_infixr 27 _^_infixr 21 _â–£_data Î â‚‚ : Type where  ğ”¹ : Î â‚‚data _â†”_ : (A B : Î â‚‚) â†’ Type where  idâ‚   : {A : Î â‚‚} â†’ (A â†” A)  notâ‚  : ğ”¹ â†” ğ”¹  !â‚_   : {A B : Î â‚‚} â†’ (A â†” B) â†’ (B â†” A)  _âŠ™_   : {A B C : Î â‚‚} â†’ (A â†” B) â†’ (B â†” C) â†’ (A â†” C)  _^_   : {A : Î â‚‚} â†’ (c : A â†” A) â†’ (n : â„•) â†’ (A â†” A)  sqrt  : {A : Î â‚‚} â†’ (c : A â†” A) â†’ (A â†” A)data _â‡”_ : {A B : Î â‚‚} (p q : A â†” B) â†’ Type where  -- some names are bad  idâ‚‚   : {A B : Î â‚‚} {c : A â†” B} â†’ c â‡” c  !â‚‚_   : {A B : Î â‚‚} {p q : A â†” B} â†’ (p â‡” q) â†’ (q â‡” p)  _âŠ™â‚‚_  : {A B : Î â‚‚} {p q r : A â†” B} â†’ (p â‡” q) â†’ (q â‡” r) â†’ (p â‡” r)    sqâŠ™sq : {A : Î â‚‚} (c : A â†” A) â†’ sqrt c âŠ™ sqrt c â‡” c  -- sqf   : {A : Î â‚‚} {c : A â†” A} â†’ sqrt (c âŠ™ c) â‡” sqrt c âŠ™ sqrt c  sqf   : {A : Î â‚‚} {p q : A â†” A} â†’ sqrt (p âŠ™ q) â‡” sqrt p âŠ™ sqrt q  sqi   : {A : Î â‚‚} {p q : A â†” A} â†’ (p â‡” q) â†’ sqrt p â‡” sqrt q  sqc   : {A : Î â‚‚} {c : A â†” A} â†’ sqrt c âŠ™ c â‡” c âŠ™ sqrt c -- derivable from assoc and sqâŠ™sq    c^0   : {A : Î â‚‚} {c : A â†” A} â†’ c ^ 0 â‡” idâ‚  factl : {A : Î â‚‚} {c : A â†” A} {n : â„•} â†’ c ^ suc n â‡” c âŠ™ c ^ n  factr : {A : Î â‚‚} {c : A â†” A} {n : â„•} â†’ c ^ suc n â‡” c ^ n âŠ™ c  idlâŠ™l : {A B : Î â‚‚} {c : A â†” B} â†’ (idâ‚ âŠ™ c) â‡” c  idrâŠ™l : {A B : Î â‚‚} {c : A â†” B} â†’ (c âŠ™ idâ‚) â‡” c  assocâŠ™l : {A B C D : Î â‚‚} {p : A â†” B} {q : B â†” C} {r : C â†” D}          â†’ (p âŠ™ q) âŠ™ r â‡” p âŠ™ (q âŠ™ r)  _â–£_   : {A B C : Î â‚‚} {câ‚ câ‚ƒ : A â†” B} {câ‚‚ câ‚„ : B â†” C}        â†’ (câ‚ â‡” câ‚ƒ) â†’ (câ‚‚ â‡” câ‚„)        -----------------------        â†’ (câ‚ âŠ™ câ‚‚) â‡” (câ‚ƒ âŠ™ câ‚„)-- equational reasoning of â‡”beginâ‚‚_ : {A B : Î â‚‚} â†’ {câ‚ câ‚‚ : A â†” B} â†’ (câ‚ â‡” câ‚‚) â†’ (câ‚ â‡” câ‚‚)beginâ‚‚ p = p_endâ‚‚ : {A B : Î â‚‚} â†’ (c : A â†” B) â†’ c â‡” cc endâ‚‚ = idâ‚‚_â‡”âŸ¨_âŸ©_ : {A B : Î â‚‚} â†’ (câ‚ : A â†” B) â†’ {câ‚‚ câ‚ƒ : A â†” B}       â†’ (câ‚ â‡” câ‚‚) â†’ (câ‚‚ â‡” câ‚ƒ) â†’ (câ‚ â‡” câ‚ƒ)câ‚ â‡”âŸ¨ p âŸ© q = p âŠ™â‚‚ q_â‡”âŸ¨âŸ©_ : {A B : Î â‚‚} â†’ (câ‚ : A â†” B) â†’ {câ‚‚ : A â†” B}      â†’ (câ‚ â‡” câ‚‚) â†’ (câ‚ â‡” câ‚‚)câ‚ â‡”âŸ¨âŸ© q = câ‚ â‡”âŸ¨ idâ‚‚ âŸ© qinfix 1 beginâ‚‚_infix 3 _endâ‚‚infixr 2 _â‡”âŸ¨_âŸ©_infixr 2 _â‡”âŸ¨âŸ©_-- examples-- should it hold natually?sqrt-câŠ™c : {A : Î â‚‚} {c : A â†” A} â†’ sqrt (c âŠ™ c) â‡” csqrt-câŠ™c {A} {c} =  beginâ‚‚    sqrt (c âŠ™ c)  â‡”âŸ¨ sqf âŸ©    sqrt c âŠ™ sqrt c  â‡”âŸ¨ sqâŠ™sq c âŸ©    c  endâ‚‚-- sqrt (c ^ 3) â‡” sqrt c âŠ™ c-- sqrt (c ^ 3) â‡” c âŠ™ sqrt csqrt-c^3-l : {A : Î â‚‚} {c : A â†” A} â†’ sqrt (c ^ 3) â‡” sqrt c âŠ™ csqrt-c^3-l {A} {c} =  beginâ‚‚    sqrt (c ^ 3)  â‡”âŸ¨ sqi factl âŸ©    sqrt (c âŠ™ c ^ 2)  â‡”âŸ¨ sqf âŸ©    sqrt c âŠ™ sqrt (c ^ 2)  â‡”âŸ¨ idâ‚‚ â–£ sqi factl âŸ©    sqrt c âŠ™ sqrt (c âŠ™ c ^ 1)  â‡”âŸ¨ idâ‚‚ â–£ sqf âŸ©    sqrt c âŠ™ (sqrt c âŠ™ sqrt (c ^ 1))  â‡”âŸ¨ idâ‚‚ â–£ idâ‚‚ â–£ sqi factl  âŸ©    sqrt c âŠ™ (sqrt c âŠ™ sqrt (c âŠ™ c ^ 0))  â‡”âŸ¨ idâ‚‚ â–£ idâ‚‚ â–£ sqi (idâ‚‚ â–£ c^0) âŸ©  -- Ê»idâ‚‚ â–£ Ê»idâ‚‚ â–£ Ê»sqf ???    sqrt c âŠ™ (sqrt c âŠ™ sqrt (c âŠ™ idâ‚))  â‡”âŸ¨ idâ‚‚ â–£ idâ‚‚ â–£ sqi idrâŠ™l âŸ©    sqrt c âŠ™ (sqrt c âŠ™ sqrt c)  â‡”âŸ¨ idâ‚‚ â–£ sqâŠ™sq c âŸ©    sqrt c âŠ™ c  endâ‚‚  sqrt-c^3-r : {A : Î â‚‚} {c : A â†” A} â†’ sqrt (c ^ 3) â‡” c âŠ™ sqrt csqrt-c^3-r {A} {c} =  beginâ‚‚    sqrt (c ^ 3)  â‡”âŸ¨ sqrt-c^3-l âŸ©    sqrt c âŠ™ c  â‡”âŸ¨ sqc âŸ©    c âŠ™ sqrt c  endâ‚‚{--explore the behavior of (sqrt id) and (sqrt not) :(sqrt id)  : can be id SUPEROR not(sqrt not) : ...--}âŸ¦_âŸ§ : Î â‚‚ â†’ TypeâŸ¦ ğ”¹ âŸ§ = Boolnot-path : Bool â‰¡ Boolnot-path = isoToPath (iso not not rem rem)  where    rem : (b : Bool) â†’ not (not b) â‰¡ b    rem false = refl    rem true  = refl{-# TERMINATING #-}evalâ†”toâ‰¡ : {A B : Î â‚‚} (i : I) (c : A â†” B) â†’ âŸ¦ A âŸ§ â‰¡ âŸ¦ B âŸ§evalâ†”toâ‰¡ i idâ‚         = reflevalâ†”toâ‰¡ i notâ‚        = not-pathevalâ†”toâ‰¡ i (!â‚ c)      = sym (evalâ†”toâ‰¡ i c)evalâ†”toâ‰¡ i (p âŠ™ q)     = evalâ†”toâ‰¡ i p âˆ™ evalâ†”toâ‰¡ i qevalâ†”toâ‰¡ i (c ^ 0)     = reflevalâ†”toâ‰¡ i (c ^ suc n) = evalâ†”toâ‰¡ i c âˆ™ evalâ†”toâ‰¡ i (c ^ n)evalâ†”toâ‰¡ i (sqrt c)    = {!!}-- fst (sqrtâ‰¡ (evalâ†”toâ‰¡ i {!!}) i)eval0 : Bool â‰¡ Bool â†’ (i : I) â†’ Partial (~ i âˆ¨ i) Booleval0 p i (i = i0) = trueeval0 p i (i = i1) = transport p true